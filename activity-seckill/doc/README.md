# 产品设计

## 限流

- 一个用户只能买一件 限制羊毛党
- 需要绑定手机号 绑定银行卡 表明：身份信息没问题
- 需要用户有一定的消费记录
- 客户端
    - 防止重复点击
    - 隐藏秒杀链接：秒杀地址需要一个专门的接口返回, 并携带随机字符串防止暴力扫描, 这个接口只有在活动开始的时候才会返回正确的地址,
      让黑产无法通过扫描代码获取秒杀地址
- 网关层
    - 限制IP和用户频率
    - 黑名单:
    - 鉴权：未登录的用户, 无法访问秒杀接口

## 库存

- 下单扣库存，而不是付款时扣库存

## 简化流程

- 取消普通商品的提交订单的页面，用户点击购买按钮，进入订单页面，可以直接提交订单
    - 目的： 降低用户锁库存的时间，进一步减少恶意用户锁库存

# 技术实现方案

- 同步处理，抢库存、写订单，加锁并且直接写数据库
- 异步处理，先发送MQ，返回给用户一个Token，客户端再轮训带着token请求是否抢购成功。