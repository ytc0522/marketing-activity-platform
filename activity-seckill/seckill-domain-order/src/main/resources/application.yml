server:
  port: 8200


# 设置nacos的地址（配置中心）
nacos:
  discovery:
    server-addr: hadoop101:8848

# Dubbo 广播方式配置，如果调用不稳定可以修改为直连模式：https://codechina.csdn.net/KnowledgePlanet/Lottery/-/issues/1
dubbo:
  application:
    name: seckill-order-service
    version: 1.0.0
  registry:
    address: nacos://hadoop101:8848
  protocol:
    name: dubbo
    port: -1

# Mybatis
mybatis-plus:
  global-config:
    banner: false
    db-config:
      id-type: ID_WORKER
      logic-delete-value: 1
      logic-not-delete-value: 0
      insert-strategy: NOT_NULL
      update-strategy: NOT_NULL
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
    cache-enabled: false
    map-underscore-to-camel-case: true
    call-setters-on-nulls: true
    jdbc-type-for-null: 'null'

spring:
  application:
    name: seckill-order
  main:
    allow-bean-definition-overriding: true
  #  datasource:
  #    driver-class-name: com.mysql.cj.jdbc.Driver
  #    username: root
  #    password: rootroot
  #    url: jdbc:mysql://hadoop101:3306/activity_order_seckill_1
  redis:
    database: 0
    host: hadoop101     # Redis服务器地址，修改为你的地址
    port: 6379          # Redis服务器连接端口
    password:           # Redis服务器连接密码（默认为空）
    timeout: 3000       # Redis服务器链接超时配置


  cloud:
    stream:
      binders:
        defaultRabbit:
          type: rabbit
          environment:
            spring:
              rabbitmq:
                host: hadoop101
                port: 5672
                username: root
                password: 123456
                virtual-host: marketing
      rabbit:
        bindings:
          input:
            consumer:
              acknowledge-mode: manual
      bindings:
        input:
          destination: ACTIVITY_EVENT_TOPIC
          group: ${spring.application.name}
        output:
          destination: ACTIVITY_EVENT_TOPIC
          group: ${spring.application.name}


  # sharding-jdbc
  shardingsphere:
    datasource:
      names: ds-order-1,ds-order-2
      ds-order-1:
        type: com.zaxxer.hikari.HikariDataSource
        driver-class-name: com.mysql.cj.jdbc.Driver
        jdbc-url: jdbc:mysql://hadoop101:3306/activity_order_seckill_1
        username: root
        password: rootroot
      ds-order-2:
        type: com.zaxxer.hikari.HikariDataSource
        driver-class-name: com.mysql.cj.jdbc.Driver
        jdbc-url: jdbc:mysql://hadoop101:3306/activity_order_seckill_2
        username: root
        password: rootroot
    # 分片策略配置
    sharding:
      tables:
        seckill_order:
          actual-data-nodes: ds-order-${1..2}.seckill_order_$->{0..1}
          table-strategy:
            standard:
              sharding-column: user_id
              precise-algorithm-class-name: marketing.activity.seckill.order.sharding.PreciseHashShardingConfig
          database-strategy:
            standard:
              sharding-column: user_id
              precise-algorithm-class-name: marketing.activity.seckill.order.sharding.PreciseHashShardingConfig
    props:
      sql:
        show: true




